<script>
    var btnSignUp = document.getElementById("btnSignUp");
    
    btnSignUp.addEventListener("click", show_signUpForm, false);
    
    function show_signUpForm()
    {
        var respectlyFormId = document.getElementById("emergentWindow");

        respectlyFormId.style.width = "100%";
        respectlyFormId.style.height = "100%";
        respectlyFormId.style.opacity = "0.9";
        respectlyFormId.style.zIndex = "20";
        respectlyFormId.style.position = "absolute";
        respectlyFormId.style.color = "white";
        respectlyFormId.style.backgroundColor = "gray";
        respectlyFormId.style.overflowY = "scroll";
        
        respectlyFormId.innerHTML = 
        "<center>"+
        
        "<form id='signUp_form'>"+
        
        "<table width='600px' border='1'>"+
        
            "<tr>"+
                "<td colspan='2' align='right'>"+
                "<div style='background-color:white; padding:5px; opacity: 0.5; color: gray; width:100%; height:30px;'>"+
                    "<center>SIGN UP</center>"+
                "</div>"+
                "</td>"+
            "</tr>"+
            
            "<tr>"+
                "<td colspan='2' align='right'>"+
                "<div id='close_signUp' style='cursor:pointer; background-color:red; padding:5px; opacity: 0.5; color: white; width:40px; height:30px;'><center>X</center></div>"+
                "</td>"+
            "</tr>"+
            
            
            
            
            
            
            
        
            "<tr height='40px'>"+
                "<td>"+
                    "User's Name: "+
                "</td>"+
                "<td>"+
                
                    "<input id='user_name_signUp' onpaste='return false' class='defaultInput'"+
                    "type='text' "+
                    "name='user_name_signUp' "+
                    "size='19' "+
                    "placeholder='Username'/>"+
                
                "</td>"+
            "</tr>"+
            
            "<tr height='40px'>"+
                "<td>"+
                    "User's First given name: "+
                "</td>"+
                "<td>"+
                
                    "<input id='user_firstGivenName' onpaste='return false' class='defaultInput'"+
                    "type='text' "+
                    "name='user_firstGivenName' "+
                    "size='19' "+
                    "placeholder='First given name'/>"+
                
                "</td>"+
            "</tr>"+
            
            "<tr height='40px'>"+
                "<td>"+
                    "User's Second given name: "+
                "</td>"+
                "<td>"+
                
                    "<input id='user_secondGivenName' onpaste='return false' class='defaultInput'"+
                    "type='text' "+
                    "name='user_secondGivenName' "+
                    "size='19' "+
                    "placeholder='Second given name'/>"+
                
                "</td>"+
            "</tr>"+
            
            "<tr height='40px'>"+
                "<td>"+
                    "User's First family name: "+
                "</td>"+
                "<td>"+
                
                    "<input id='user_firstFamilyName' onpaste='return false' class='defaultInput'"+
                    "type='text' "+
                    "name='user_firstFamilyName' "+
                    "size='19' "+
                    "placeholder='First family name'/>"+
                
                "</td>"+
            "</tr>"+
            
            "<tr height='40px'>"+
                "<td>"+
                    "User's Second family name: "+
                "</td>"+
                "<td>"+
                
                    "<input id='user_secondFamilyName' onpaste='return false' class='defaultInput'"+
                    "type='text' "+
                    "name='user_secondFamilyName' "+
                    "size='19' "+
                    "placeholder='Second family name'/>"+
                
                "</td>"+
            "</tr>"+
            
            "<tr height='40px'>"+
                "<td>"+
                    "User's Email: "+
                "</td>"+
                "<td>"+
                
                    "<input id='user_email' onpaste='return false' class='defaultInput'"+
                    "type='text' "+
                    "name='user_email' "+
                    "size='19' "+
                    "placeholder='Email'/>"+
                
                "</td>"+
            "</tr>"+
            
            "<tr height='40px'>"+
                "<td>"+
                    "User's Password: "+
                "</td>"+
                "<td>"+
                
                    "<input id='user_password_signUp' onpaste='return false' class='defaultInput'"+
                    "type='password' "+
                    "name='user_password_signUp' "+
                    "size='19' "+
                    "placeholder='Password'/>"+
                
                "</td>"+
            "</tr>"+

            "<tr height='40px'>"+
                "<td>"+
                    "User's Country: "+
                "</td>"+
                "<td>"+
                
                    "<select id='user_country' class='defaultInput' name='user_country' onchange='getCity();'>"+
                    "</select>"+
                
                "</td>"+
            "</tr>"+
            
            "<tr height='40px'>"+
                "<td>"+
                    "User's City: "+
                "</td>"+
                "<td>"+
                
                    "<select id='user_city' class='defaultInput' name='user_city'>"+
                    "</select>"+
                
                "</td>"+
            "</tr>"+
            
            "<tr height='300px'>"+
                "<td>"+
                    "User's Biography:"+
                "</td>"+
                "<td>"+
                    
                    "<textarea "+
                    "id='user_biography' name='user_biography' "+
                    "style='"+
                    "height: 300px;"+
                    "width: 100%;"+
                    "color: gray;"+
                    "resize: none;"+
                    "overflow-y: scroll;' "+
                    " class='defaultInput' ></textarea>"+
                    
                "</td>"+
            "</tr>"+
            
            
            
            
            
            "<tr height='40px'>"+
                "<td>"+
                    "User's profile photo: "+
                "</td>"+
                "<td>"+
                
                "<input type='file' name='user_profilePhoto' id='user_profilePhoto'/>"+
                
                "</td>"+
            "</tr>"+
            
            "<tr height='40px'>"+
                "<td colspan='2'>"+
                
                "<center>"+
                    "<div id='save_signUp' style='cursor:pointer; background-color:blue; padding:5px; opacity: 0.5; width:60px; height:30px;'>"+
                    "SAVE"+
                    "</div>"+
                "</center>"+
                
                "</td>"+
            "</tr>"+
            
        "</table>"+
        
        "</form>"+
        
        "</center>";


        getCountry();
                
        $('#close_signUp').click(function () {
        var respectlyFormId = document.getElementById("emergentWindow");

            respectlyFormId.style.width = "100%";
            respectlyFormId.style.height = "100%";
            respectlyFormId.style.opacity = "0";
            respectlyFormId.style.zIndex = "1";
            respectlyFormId.style.position = "absolute";

            respectlyFormId.innerHTML = "";
        });
        
        $('#save_signUp').click(function () {
            signUpUser();

            respectlyFormId.style.width = "100%";
            respectlyFormId.style.height = "100%";
            respectlyFormId.style.opacity = "0";
            respectlyFormId.style.zIndex = "1";
            respectlyFormId.style.position = "absolute";
            respectlyFormId.innerHTML = "";
        });
        
        
        $('#user_name_signUp')
        .keypress(function (e) {
            return solo_letras_numeros(e);
        });
        
        $('#user_firstGivenName')
        .keypress(function (e) {
            return solo_letras(e);
        });
        
        $('#user_secondGivenName')
        .keypress(function (e) {
            return solo_letras(e);
        });
        
        $('#user_firstFamilyName')
        .keypress(function (e) {
            return solo_letras(e);
        });
        
        $('#user_secondFamilyName')
        .keypress(function (e) {
            return solo_letras(e);
        });
        
        $('#user_country')
        .keypress(function (e) {
            return solo_letras(e);
        });
        
        $('#user_city')
        .keypress(function (e) {
            return solo_letras(e);
        });
        
    }
    
    function signUpUser()
    {
        var form = $('#sign-up-ajax');
        var url = form.attr('action');
        
        user_name_signUp = document.getElementById('user_name_signUp').value;
        user_firstGivenName = document.getElementById('user_firstGivenName').value;
        user_secondGivenName = document.getElementById('user_secondGivenName').value;
        user_firstFamilyName = document.getElementById('user_firstFamilyName').value;
        user_secondFamilyName = document.getElementById('user_secondFamilyName').value;
        user_email = document.getElementById('user_email').value;
        user_password_signUp = document.getElementById('user_password_signUp').value;
        user_biography = document.getElementById('user_biography').value;
        user_country = document.getElementById('user_country').value;
        user_city = document.getElementById('user_city').value;
        user_profilePhoto = document.getElementById('user_profilePhoto').value;
        
        if (!user_name_signUp || !user_firstGivenName || !user_firstFamilyName || !user_email || !user_password_signUp || !user_biography) {
            alert("You need to introduce all information");
        } else {

            var formData = new FormData($("#signUp_form")[0]);
            var a = 2;

            $.ajax({
                url: url,
                type: 'POST',
                data: formData,
                cache: false,
                processData: false,
                contentType: false
            }).done(function (resp) {
                var userId = resp[0].userId;
                var userProfilephoto = resp[0].userProfilephoto;
                var userName = resp[0].userName;
                var userFirstgivenname = resp[0].userFirstgivenname;
                var userSecondgivenname = resp[0].userSecondgivenname;
                var userFirstfamilyname = resp[0].userFirstfamilyname;
                var userSecondfamilyname = resp[0].userSecondfamilyname;
                var userEmail = resp[0].userEmail;
                var userPassword = resp[0].userPassword;
                var userBiography = resp[0].userBiography;
                var city = resp[0].city;
            });
            uploadProfilePhoto();            
        }
    }
    
    function uploadProfilePhoto()
    {
        var form = $('#upload-profile-photo-ajax');
        var url = form.attr('action');

        var profilePhoto = document.getElementById("user_profilePhoto").files[0];

        var formdata = new FormData();
        formdata.append("user_profilePhoto", profilePhoto);
{#        formdata.append("video_portrait", portrait);#}

        var ajax = new XMLHttpRequest();
        
        ajax.open("POST", url);
        ajax.send(formdata);
    }
    
    function getCountry()
    {
        var form = $('#get-country-ajax');
        var url = form.attr('action');

        $.post(url, function (data)
        {
            var amountCountries = data[0].amountCountries;
            
            var user_country = document.getElementById("user_country");
            user_country.innerHTML = "";
            
            var i = 0;
            while(i < amountCountries)
            {
                var countryId = data[i].countryId;
                var countryName = data[i].countryName;

                $("#user_country").append(
                    "<option id='user_country" + i + "' name='user_country" + i + "' value=" + countryName + ">" + countryName + "</option>"
                );

                i++;
            }
            
        }).fail(function () {
            alert('ERROR... GET COUNTRY');
        });
    }
    
    function getCity()
    {
        var form = $('#get-city-ajax');
        var url = form.attr('action');

        var user_country = document.getElementById("user_country").value;

        $.post(url, {user_country: user_country}, function (data)
        {
            var amountCities = data[0].amountCities;
            
            var user_city = document.getElementById("user_city");
            user_city.innerHTML = "";
            
            var i = 0;
            while(i < amountCities)
            {

                var cityId = data[i].cityId;
                var cityName = data[i].cityName;

                $("#user_city").append(
                    "<option id='user_city" + i + "' name='user_city" + i + "' value=" + cityName + ">" + cityName + "</option>"
                );

                i++;
            }
            
        }).fail(function () {
            alert('ERROR... GET CITY');
        });
    }
    
    
    
</script>